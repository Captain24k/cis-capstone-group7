<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Anonymous Feedback</title>

	<!--DO NOT FORGET THIS SCRIPT TAG SO YOU CAN USE JQUERY!!!!! -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
	<script type="text/javascript">

		////////////////////////////////////////////////////////////////////////
		
		function TestButtonHandler() {
			var webMethod = "ProjectServices.asmx/TestConnection";
			var parameters = "{}";

			//jQuery ajax method
			$.ajax({
				type: "POST",
				url: webMethod,
				data: parameters,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {
					var responseFromServer = msg.d;
					alert(responseFromServer);
				},
				error: function (e) {
					alert("this code will only execute if javascript is unable to access the webservice");
				}
			});
		}
		////////////////////////////////////////////////////////////////////////
	

		////////////////////////////////////////////////////////////////////////
		// SUBMIT ANONYMOUS FEEDBACK
		
		function SubmitFeedbackHandler() {

			// clear previous message
			$("#msg").text("");

			// get values from the form
			var department = $("#ddlDepartment").val();
			var category = $("#ddlCategory").val();
			var subject = $("#txtSubject").val();
			var feedbackText = $("#txtFeedback").val();

			// simple validation
			if (department == "" || category == "" || subject == "" || feedbackText == "") {
				$("#msg").css("color", "red");
				$("#msg").text("Please fill out all fields before submitting.");
				return;
			}

			// disable submit button
			$("#btnSubmit").prop("disabled", true);

			// send data to the web service
			$.ajax({
				type: "POST",
				url: "ProjectServices.asmx/SubmitAnonymousFeedback",
				data: JSON.stringify({
					department: department,
					category: category,
					subject: subject,
					feedbackText: feedbackText
				}),
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {

					// show success message
					$("#msg").css("color", "green");
					$("#msg").text("Feedback submitted successfully. Thank you!");

					// clear form fields
					$("#ddlDepartment").val("");
					$("#ddlCategory").val("");
					$("#txtSubject").val("");
					$("#txtFeedback").val("");
				},
				error: function () {
					$("#msg").css("color", "red");
					$("#msg").text("Error submitting feedback. Please try again.");
				},
				complete: function () {
					// re-enable submit button
					$("#btnSubmit").prop("disabled", false);
				}
			});
		}
		////////////////////////////////////////////////////////////////////////
		// END OF NEW FUNCTION
		////////////////////////////////////////////////////////////////////////

	</script>
	<!--END OF YOUR OWN JAVASCRIPT-->

	<!--AND YOUR OWN CSS CAN GO HERE AS WELL-->
	<style>
		body {
			font-family: Arial;
			background: #f4f4f4;
			margin: 0;
			padding: 0;
		}

		.box {
			width: 520px;
			margin: 40px auto;
			background: white;
			padding: 20px;
			border: 1px solid #ddd;
			border-radius: 6px;
		}

		h2 {
			margin-top: 0;
		}

		label {
			display: block;
			margin-top: 12px;
			font-weight: bold;
		}

		select,
		input,
		textarea {
			width: 100%;
			box-sizing: border-box;
			padding: 8px;
			margin-top: 6px;
			border: 1px solid #bbb;
			border-radius: 4px;
			font-size: 14px;
		}

		textarea {
			height: 120px;
			resize: vertical;
		}

		.buttons {
			margin-top: 15px;
		}

		button {
			padding: 8px 12px;
			border: none;
			border-radius: 4px;
			cursor: pointer;
			margin-right: 8px;
		}

		#btnSubmit {
			background: #2d7ef7;
			color: white;
		}

		#btnTest {
			background: #444;
			color: white;
		}

		#msg {
			margin-top: 12px;
			font-size: 14px;
			min-height: 18px;
		}

		.note {
			font-size: 12px;
			color: #555;
			margin-bottom: 10px;
		}
	</style>
	<!--END OF YOUR OWN CSS-->

</head>

<body>
	<div class="box">
		<h2>Anonymous Feedback</h2>
		<p class="note">Submit feedback without logging in. Your name is not collected.</p>

		<label for="ddlDepartment">Department</label>
		<select id="ddlDepartment">
			<option value="">-- Select Department --</option>
			<option value="HR">HR</option>
			<option value="IT">IT</option>
			<option value="Finance">Finance</option>
			<option value="Operations">Operations</option>
			<option value="Other">Other</option>
		</select>

		<label for="ddlCategory">Category</label>
		<select id="ddlCategory">
			<option value="">-- Select Category --</option>
			<option value="Safety">Safety</option>
			<option value="Work Environment">Work Environment</option>
			<option value="Management">Management</option>
			<option value="Pay/Benefits">Pay/Benefits</option>
			<option value="Other">Other</option>
		</select>

		<label for="txtSubject">Subject</label>
		<input id="txtSubject" type="text" placeholder="Short subject..." />

		<label for="txtFeedback">Feedback</label>
		<textarea id="txtFeedback" placeholder="Write your feedback..."></textarea>

		<div class="buttons">
			<button id="btnSubmit" onclick="SubmitFeedbackHandler()">Submit</button>
			<button id="btnTest" onclick="TestButtonHandler()">Test Connection</button>
		</div>

		<div id="msg"></div>
	</div>
</body>

</html>